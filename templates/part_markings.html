{% extends 'base.html' %}
{% block title %}Verified Part Markings{% endblock %}
{% block head_extra %}
  <script src="/static/js/part_markings.js" defer></script>
{% endblock %}
{% block content %}
  <a href="/">‚Üê Home</a>
  <h1>Verified Part Markings</h1>
  <div id="container">
    <div id="markings-actions">
      <div class="action-panel">
        <div class="action-card">
          <h2>Search Verified Part</h2>
          <p class="desc">Enter a part number to highlight it in the table.</p>
          <label for="search-part-number">Part Number</label>
          <input type="text" id="search-part-number" placeholder="e.g., 10-1000" aria-label="Part number to search" title="Part number to locate">
          <p class="field-desc">Highlight matching part number in the table.</p>
          <button id="search-btn" type="button" title="Highlight matching part number">Search</button>
        </div>
        {% if current_user == 'ADMIN' or permissions['part_markings'] %}
        <div class="action-card">
          <h2>Add New Entry</h2>
          <p class="desc">Use this form to add a single verified part marking.</p>
          <form method="post">
            <label>Part Number
              <input type="text" name="part_number" required title="Unique part number">
            </label><br>
            <label>Mfg Number 1
              <input type="text" name="mfg_number1" title="Manufacturer number 1">
            </label><br>
            <label>Mfg Number 2
              <input type="text" name="mfg_number2" title="Manufacturer number 2">
            </label><br>
            <label>Manufacturer
              <input type="text" name="manufacturer" title="Manufacturer name">
            </label><br>
            <label>Verified Markings
              <input type="text" name="verified_markings" title="Verified markings text">
            </label><br>
            <p class="field-desc">Add the new part marking to the table.</p>
            <button type="submit" title="Add new part marking">Add</button>
          </form>
        </div>
        <div class="action-card">
          <h2>Bulk Upload</h2>
          <p class="desc">Upload an Excel file to add multiple entries at once.</p>
          <form method="post" enctype="multipart/form-data">
            <label>Excel File
              <input type="file" name="excel_file" accept=".xlsx,.xls" required title="Excel file containing part markings">
            </label><br>
            <p class="field-desc">Import rows from the selected spreadsheet.</p>
            <button type="submit" title="Upload spreadsheet">Upload</button>
          </form>
        </div>
        {% endif %}
      </div>
    </div>
    <div id="divider"></div>
    <div id="markings-table">
      <table>
        <thead>
          <tr>
            <th>Verified Markings</th>
            <th>Manufacturer</th>
            <th>Mfg Number 2</th>
            <th>Mfg Number 1</th>
            <th>Part Number</th>
          </tr>
        </thead>
        <tbody>
          {% for row in markings %}
          <tr>
            <td>{{ row['verified_markings'] }}</td>
            <td>{{ row['manufacturer'] }}</td>
            <td>{{ row['mfg_number2'] }}</td>
            <td>{{ row['mfg_number1'] }}</td>
            <td>{{ row['part_number'] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}
